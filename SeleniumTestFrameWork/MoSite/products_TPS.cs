// Generated by .NET Reflector from C:\Program Files\Default Company Name\Selenium Test Tool\MoBankUI.exe
namespace MoBankUI
{
    using OpenQA.Selenium;
    using OpenQA.Selenium.Support.UI;
    using Selenium;
    using System;
    using System.Threading;
    
    internal class products_TPS
    {
        private MoBankUI.Screenshot screenshot = new MoBankUI.Screenshot();
        
        public void product(IWebDriver driver, ISelenium selenium, datarow_TPS datarow)
        {
            string str7;
            Imagevalidation imagevalidation = new Imagevalidation();
            try
            {
                string str4;
                string str6;
                imagevalidation.productImage(driver, selenium, datarow);
                if (selenium.IsElementPresent("//body[@id='page-products-details']/div/div[2]/div/div/div/p/strong"))
                {
                    string str = driver.FindElement(By.XPath("//body[@id='page-products-details']/div/div[2]/div/div/div/p/strong")).Text;
                    datarow.newrowTPS("Product Price", "", str, "PASS", driver, selenium);
                }
                else if (!selenium.IsElementPresent("//body[@id='page-products-details']/div/div[2]/div/div/div/p/strong"))
                {
                    datarow.newrowTPS("Product Price", "Product Price is Expected", "Element Not Identified", "FAIL", driver, selenium);
                }
                else
                {
                    datarow.newrowTPS("Product Price", "Product Price is Expected", "Product Is Not Displayed", "FAIL", driver, selenium);
                }
                if (selenium.IsElementPresent("//div[@id='Description']/h4/a/span"))
                {
                    selenium.Click("//div[@id='Description']/h4/a/span");
                    if (selenium.IsElementPresent("//div[@id='Description']/div/div/div/p"))
                    {
                        string text = selenium.GetText("css=html.ui-mobile body#page-products-details.ui-mobile-viewport div.ui-page div.pageContent div.productDetails div.ui-content div#Description.ui-collapsible div.ui-collapsible-content");
                        datarow.newrowTPS("Product Detail", "", text, "PASS", driver, selenium);
                    }
                    else if (selenium.IsElementPresent("//div[@id='Description']/h4/a/span"))
                    {
                        datarow.newrowTPS("Product Detail", "Product Details Element Is Expected", "Product Detail Element Not identified", "FAIL", driver, selenium);
                    }
                    else
                    {
                        datarow.newrowTPS("Product Detail", "Product Details are Expected", "Product Details Not identified", "FAIL", driver, selenium);
                    }
                }
                if (selenium.IsElementPresent("//html/body/div/div/div[2]/h2"))
                {
                    string str3 = selenium.GetText("//html/body/div/div/div[2]/h2");
                    datarow.newrowTPS("Product Title", "", str3, "PASS", driver, selenium);
                }
                else if (!selenium.IsElementPresent("//html/body/div/div/div[2]/h2"))
                {
                    datarow.newrowTPS("Product Title", "Product Title Element is Expected", "Product Title Element Not Found", "FAIL", driver, selenium);
                }
                else
                {
                    datarow.newrowTPS("Product Title", "Product Title is Expected", "Product Title Not Found", "FAIL", driver, selenium);
                }
                if (selenium.IsElementPresent("id=Variants_0__OptionValue"))
                {
                    try
                    {
                        if (selenium.GetXpathCount("//html/body/div/div[2]/div/div[4]/form/ul/li[2]/fieldset/div[2]/div/label/span") != 1M)
                        {
                            string[] selectOptions = selenium.GetSelectOptions("id=Variants_0__OptionValue");
                            str4 = null;
                            foreach (string str5 in selectOptions)
                            {
                                if (str5 != "Please Select")
                                {
                                    str4 = str4 + "\r\n" + str5;
                                    new SelectElement(driver.FindElement(By.Id("Variants_0__OptionValue"))).SelectByText(str5);
                                }
                            }
                            datarow.newrowTPS("Variants", "", str4, "PASS", driver, selenium);
                        }
                        else
                        {
                            str6 = selenium.GetValue("id=Variants_0__OptionValue");
                            datarow.newrowTPS("Variants", "", str6, "PASS", driver, selenium);
                        }
                    }
                    catch (Exception exception1)
                    {
                        Exception exception = exception1;
                        str7 = exception.ToString();
                        datarow.newrowTPS("Exception at Product variants", "Exception Not Expected", str7, "FAIL", driver, selenium);
                    }
                }
                else if (selenium.IsElementPresent("id=OptionValue_0"))
                {
                    try
                    {
                        bool flag;
                      
                        str4 = null;
                        int num2 = 1;
                        goto Label_03D4;
                    Label_0346:
                        if (!selenium.IsElementPresent("id=OptionValue_" + num2))
                        {
                            goto Label_03DC;
                        }
                        str6 = selenium.GetText("id=OptionValue_" + num2);
                        if ((str6 != "Please Select") || (str6 != null))
                        {
                            str4 = str4 + "\r\n" + str6;
                            selenium.Click("id=OptionValue_" + num2);
                        }
                        num2++;
                    Label_03D4:
                        flag = true;
                        goto Label_0346;
                    Label_03DC:
                        datarow.newrowTPS("Variants", "", str4, "PASS", driver, selenium);
                    }
                    catch (Exception exception2)
                    {
                        str7 = exception2.ToString();
                        datarow.newrowTPS("Exception at Product Variants", "Exception Not Expected", str7, "FAIL", driver, selenium);
                    }
                }
                string str8 = driver.PageSource;
                ((IJavaScriptExecutor) driver).ExecuteScript("window.scrollBy(0,400)", new object[0]);
                try
                {
                    driver.Manage().Timeouts().ImplicitlyWait(TimeSpan.FromSeconds(10.0));
                    driver.FindElement(By.XPath("//p[@id='AddToBasketButton']/div[2]/input")).Click();
                    datarow.newrowTPS("Add to Basket Button", "Add To Basket Button is Expected", "//p[@id='AddToBasketButton']/div[2]/inputAdd To Basket Element Is Present", "PASS", driver, selenium);
                    Thread.Sleep(0x1388);
                }
                catch (Exception exception3)
                {
                    str7 = exception3.ToString();
                    datarow.newrowTPS("Add to Basket Button", "Add To Basket Button is Expected", str7, "FAIL", driver, selenium);
                    this.screenshot.screenshotfailed(driver, selenium);
                }
                string actual = driver.FindElement(By.Id("BasketInfo")).Text;
                if (actual == "(1)")
                {
                    datarow.newrowTPS("Basket Value", "(1)", actual, "PASS", driver, selenium);
                }
                else
                {
                    datarow.newrowTPS("Basket Value", "(1)", actual, "FAIL", driver, selenium);
                    this.screenshot.screenshotfailed(driver, selenium);
                }
                driver.FindElement(By.XPath("//div[@id='AddedDetail']/ul/li/p/a/span/span")).Click();
                selenium.WaitForPageToLoad("30000");
                driver.Manage().Timeouts().ImplicitlyWait(TimeSpan.FromSeconds(10.0));
                IWebElement element = driver.FindElement(By.XPath("//a[@id='GoToCheckout']/span/span"));
                string str10 = driver.FindElement(By.Id("BasketInfo")).Text;
                if (str10 == "(1)")
                {
                    datarow.newrowTPS("Basket Value", "(1)", str10, "PASS", driver, selenium);
                }
                else
                {
                    datarow.newrowTPS("Basket Value", "(1)", str10, "FAIL", driver, selenium);
                    this.screenshot.screenshotfailed(driver, selenium);
                }
            }
            catch (Exception exception4)
            {
                str7 = exception4.ToString();
                datarow.newrowTPS("Exception", "Exception Not Expected", str7, "FAIL", driver, selenium);
                this.screenshot.screenshotfailed(driver, selenium);
            }
        }
    }
}
