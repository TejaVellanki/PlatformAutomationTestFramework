// Generated by .NET Reflector from C:\Program Files\Default Company Name\Selenium Test Tool\MoBankUI.exe

using System;
using System.Data;
using System.Threading;
using OpenQA.Selenium;
using OpenQA.Selenium.Support.UI;
using Selenium;

namespace MoBankUI
{
    internal class products
    {
        private GeneralLibrary gereneralLibrary;

        public void comparedatarow(IWebDriver driver, ISelenium selenium, datarow datarow, DataTable dt)
        {
            gereneralLibrary = new GeneralLibrary();
            DataTable table =
                gereneralLibrary.GetExcelData(@"C:\Selenium\Input Data\ModrophenialiveProducts.xlsx", "Products").Tables
                    [0];
            for (int i = 1; i < (table.Rows.Count - 1); i++)
            {
                string actual = table.Rows[i]["Product Price"].ToString();
                string str2 = table.Rows[i]["Product Title"].ToString();
                string str3 = table.Rows[i]["Product Detail"].ToString();
                string expected = table.Rows[i]["Item Number"].ToString();
                string str5 = table.Rows[i]["Variants"].ToString();
                string str6 = dt.Rows[i]["Price"].ToString();
                string str7 = dt.Rows[i]["Title"].ToString();
                string str8 = dt.Rows[i]["Detail"].ToString();
                string str9 = dt.Rows[i]["Item Number"].ToString();
                string str10 = dt.Rows[i]["Variants"].ToString();
                if (str6 == actual)
                {
                    datarow.newrow(str7 + " Price", str6, actual, "PASS", driver, selenium);
                }
                else
                {
                    datarow.newrow(str7 + " Price", str6, actual, "FAIL", driver, selenium);
                }
                if (str7.ToUpper() == str2)
                {
                    datarow.newrow(str7 + " Title", str7, str2, "PASS", driver, selenium);
                }
                else
                {
                    datarow.newrow(str7 + " Title", str7, str2, "FAIL", driver, selenium);
                }
                if (str8 == str3)
                {
                    datarow.newrow(str7 + " Detail", str8, str3, "PASS", driver, selenium);
                }
                else
                {
                    datarow.newrow(str7 + " Detail", str8, str3, "FAIL", driver, selenium);
                }
                if (expected == str9)
                {
                    datarow.newrow(str7 + " ItemNumber", expected, str9, "PASS", driver, selenium);
                }
                else
                {
                    datarow.newrow(str7 + " ItemNumber", expected, str9, "FAIL", driver, selenium);
                }
                if (str5.TrimStart(new char[0]) == str10.TrimStart(new char[0]))
                {
                    datarow.newrow(str7 + " Variants", str5, str10, "PASS", driver, selenium);
                }
                else
                {
                    datarow.newrow(str7 + " Variants", str5, str10, "FAIL", driver, selenium);
                }
            }
        }

        public void product(datarow datarow, IWebDriver driver, ISelenium selenium)
        {
            string str8;
            try
            {
                var dt = new DataTable();
                driver.Navigate().GoToUrl("https://qamodrophenia.mobankdev.com/");
                driver.FindElement(By.XPath("//body[@id='page-home-index']/div/div[2]/div/ul/li[1]/div/div/a/h2"))
                      .Click();
                selenium.WaitForPageToLoad("60000");
                dt.Columns.Add("Price");
                dt.Columns.Add("Title");
                dt.Columns.Add("Detail");
                dt.Columns.Add("Item Number");
                dt.Columns.Add("Variants");
                int num = 1;
                int num2 = 0;
                goto Label_0449;
                Label_0099:
                if ((num > 1) && selenium.IsElementPresent("link=Next 30"))
                {
                    selenium.Click("link=Next 30");
                    selenium.WaitForPageToLoad("30000");
                }
                decimal xpathCount = selenium.GetXpathCount("//body[@id='page-categories-details']/div/div[2]/div/ul/li");
                for (int i = 1; i <= xpathCount; i++)
                {
                    string text;
                    string str4;
                    string str5;
                    string str7;
                    driver.FindElement(
                        By.XPath("//body[@id='page-categories-details']/div/div[2]/div/ul/li[" + i + "]/div/div/a"))
                          .Click();
                    selenium.WaitForPageToLoad("60000");
                    DataRow row = dt.NewRow();
                    string str =
                        driver.FindElement(
                            By.XPath("//body[@id='page-products-details']/div/div[2]/div/div/div/p/strong")).Text;
                    string str2 = driver.FindElement(By.XPath("//html/body/div/div/div[2]/h2")).Text;
                    row[0] = str;
                    row[1] = str2;
                    if (selenium.IsElementPresent("//div[@id='Description']/div/div/div/div/p[2]"))
                    {
                        text = selenium.GetText("//div[@id='Description']/div/div/div/div/p[2]");
                        str4 = selenium.GetText("//div[@id='Description']/div/div/div/div/p/strong");
                        row[2] = text;
                        row[3] = str4;
                    }
                    else
                    {
                        text = selenium.GetText("//div[@id='Description']/div/div/div/div/p");
                        str4 = "Item Number Not Present";
                        row[2] = text;
                        row[3] = str4;
                    }
                    if (selenium.IsElementPresent("id=Variants_0__OptionValue"))
                    {
                        try
                        {
                            if (
                                selenium.GetXpathCount(
                                    "//html/body/div/div[2]/div/div[3]/form/ul/li[2]/fieldset/div[2]/div/label/span") !=
                                1)
                            {
                                try
                                {
                                    string[] selectOptions = selenium.GetSelectOptions("id=Variants_0__OptionValue");

                                    str5 = null;
                                    foreach (string str6 in selectOptions)
                                    {
                                        if (str6 != "Please Select")
                                        {
                                            str5 = str5 + "\r\n" + str6;
                                            new SelectElement(driver.FindElement(By.Id("Variants_0__OptionValue")))
                                                .SelectByText(str6);
                                        }
                                    }
                                    row[4] = str5;
                                }
                                catch (Exception ex)
                                {
                                }
                            }
                            else
                            {
                                str7 = selenium.GetValue("id=Variants_0__OptionValue");
                                row[4] = str7;
                            }
                        }
                        catch (Exception exception1)
                        {
                            Exception exception = exception1;
                            str8 = exception.ToString();
                            datarow.newrow("Exception at Product variants", "Exception Not Expected", str8, "FAIL",
                                           driver, selenium);
                        }
                    }
                    else if (selenium.IsElementPresent("id=OptionValue_0"))
                    {
                        try
                        {
                            bool flag;
                            str5 = null;
                            int num6 = 1;
                            goto Label_03A7;
                            Label_0319:
                            if (!selenium.IsElementPresent("id=OptionValue_" + num6))
                            {
                                goto Label_03AF;
                            }
                            str7 = selenium.GetText("id=OptionValue_" + num6);
                            if ((str7 != "Please Select") || (str7 != null))
                            {
                                str5 = str5 + "\r\n" + str7;
                                selenium.Click("id=OptionValue_" + num6);
                            }
                            num6++;
                            Label_03A7:
                            flag = true;
                            goto Label_0319;
                            Label_03AF:
                            row[4] = str5;
                        }
                        catch (Exception exception2)
                        {
                            str8 = exception2.ToString();
                            datarow.newrow("Exception at Product Variants", "Exception Not Expected", str8, "FAIL",
                                           driver, selenium);
                        }
                    }
                    dt.Rows.Add(row);
                    selenium.GoBack();
                    Thread.Sleep(3000);
                }
                num++;
                if (!selenium.IsElementPresent("link=Next 30"))
                {
                    goto Label_0451;
                }
                num2++;

                Label_0449:
                //flag = true;
                goto Label_0099;
                Label_0451:
                comparedatarow(driver, selenium, datarow, dt);
            }
            catch (Exception exception3)
            {
                str8 = exception3.ToString();
                datarow.newrow("Exception", "Not Expected", str8, "FAIL", driver, selenium);
            }
        }
    }
}