// Generated by .NET Reflector from C:\Program Files\Default Company Name\Selenium Test Tool\MoBankUI.exe
namespace MoBankUI
{
    using OpenQA.Selenium;
    using OpenQA.Selenium.Support.UI;
    using Selenium;
    using System;
    using System.Data;
    using System.Text.RegularExpressions;
    using System.Threading;
    
    public class Mopaysite
    {
        private MoBankUI.datarow datarow = new MoBankUI.datarow();
        private GeneralLibrary generalLibrary;
        public WebDriverBackedSelenium selenium;
        
        public void MoPay(IWebDriver driver, ISelenium selenium, MoBankUI.datarow datarow)
        {
            this.generalLibrary = new GeneralLibrary();
            DataTable table = this.generalLibrary.GetExcelData(@"C:\Selenium\Input Data\CardDetails.xls", "CardDetails").Tables[0];
            MoBankUI.Screenshot screenshot = new MoBankUI.Screenshot();
            try
            {
                string actual = driver.FindElement(By.XPath("//div[@id='total-amount']/dl/dd")).Text;
                if (actual.Contains("\x00a3"))
                {
                    datarow.newrow("Currency Validation", "\x00a3", actual, "PASS", driver, selenium);
                }
                else
                {
                    datarow.newrow("Currency Validation", "\x00a3", actual, "FAIL", driver, selenium);
                }
            }
            catch (Exception exception)
            {
                string str2 = exception.ToString();
                datarow.newrow("Exception", "Exception Not Expected", str2, "FAIL", driver, selenium);
            }
            int num = 0;
            int count = table.Rows.Count;
            for (int i = 0; i < count; i++)
            {
                try
                {
                    string input = table.Rows[i]["FirstName"].ToString();
                    string str4 = table.Rows[i]["LastName"].ToString();
                    string str5 = table.Rows[i]["Card Number"].ToString();
                    string str6 = table.Rows[i]["Security Code"].ToString();
                    string expected = table.Rows[i]["CardType"].ToString();
                    string str8 = table.Rows[i]["Name on Card"].ToString();
                    string text = table.Rows[i]["ExpiryMonth"].ToString();
                    string str10 = table.Rows[i]["Expiry Year"].ToString();
                    string str11 = table.Rows[i]["E-mail"].ToString();
                    string str12 = table.Rows[i]["Phone Number"].ToString();
                    string str13 = table.Rows[i]["Address"].ToString();
                    string str14 = table.Rows[i]["City"].ToString();
                    string str15 = table.Rows[i]["Post Code"].ToString();
                    string str16 = table.Rows[i]["County"].ToString();
                    string str17 = table.Rows[i]["Country"].ToString();
                    new SelectElement(driver.FindElement(By.Id("Card_Type"))).SelectByText("Visa");
                    driver.FindElement(By.Id("Card_Number")).Clear();
                    driver.FindElement(By.Id("Card_Number")).SendKeys(str5);
                    driver.FindElement(By.Id("Card_SecurityCode")).Clear();
                    driver.FindElement(By.Id("Card_SecurityCode")).SendKeys(str6);
                    driver.FindElement(By.Id("Card_Name")).Clear();
                    driver.FindElement(By.Id("Card_Name")).SendKeys(str8);
                    new SelectElement(driver.FindElement(By.Id("Card_ExpiryDate_Month"))).SelectByText(text);
                    new SelectElement(driver.FindElement(By.Id("Card_ExpiryDate_Year"))).SelectByText(str10);
                    if (num < 1)
                    {
                        driver.FindElement(By.Id("change-address")).Click();
                        selenium.WaitForPageToLoad("30000");
                        num++;
                    }
                    driver.FindElement(By.Id("BillingContact_FirstName")).Clear();
                    driver.FindElement(By.Id("BillingContact_FirstName")).SendKeys(input);
                    driver.FindElement(By.Id("BillingContact_LastName")).Clear();
                    driver.FindElement(By.Id("BillingContact_LastName")).SendKeys(str4);
                    driver.FindElement(By.Id("BillingContact_Email")).Clear();
                    driver.FindElement(By.Id("BillingContact_Email")).SendKeys(str11);
                    driver.FindElement(By.Id("BillingContact_Phone_Number")).Clear();
                    driver.FindElement(By.Id("BillingContact_Phone_Number")).SendKeys(str12);
                    driver.FindElement(By.Id("BillingContact_Address_Line1")).Clear();
                    driver.FindElement(By.Id("BillingContact_Address_Line1")).SendKeys(str13);
                    driver.FindElement(By.Id("BillingContact_Address_Line2")).Clear();
                    driver.FindElement(By.Id("BillingContact_Address_Line2")).SendKeys("Address2");
                    driver.FindElement(By.Id("BillingContact_Address_Postcode")).Clear();
                    driver.FindElement(By.Id("BillingContact_Address_Postcode")).SendKeys(str15);
                    driver.FindElement(By.Id("BillingContact_Address_Town")).Clear();
                    driver.FindElement(By.Id("BillingContact_Address_Town")).SendKeys(str14);
                    driver.FindElement(By.Id("BillingContact_Address_County")).Clear();
                    driver.FindElement(By.Id("BillingContact_Address_County")).SendKeys(str16);
                    if (str17.Length == 0)
                    {
                        string[] selectOptions = selenium.GetSelectOptions("id=BillingContact_Address_Country");
                        foreach (string str18 in selectOptions)
                        {
                            new SelectElement(driver.FindElement(By.Id("BillingContact_Address_Country"))).SelectByText(str18);
                            if (str18 == "")
                            {
                                break;
                            }
                        }
                    }
                    if (str17.Length > 0)
                    {
                        string[] strArray2 = selenium.GetSelectOptions("id=BillingContact_Address_Country");
                        foreach (string str19 in strArray2)
                        {
                            new SelectElement(driver.FindElement(By.Id("BillingContact_Address_Country"))).SelectByText(str19);
                            if (str19 == "United Kingdom")
                            {
                                break;
                            }
                        }
                    }
                    driver.FindElement(By.Name("PostAction[Complete]")).Click();
                    selenium.WaitForPageToLoad("30000");
                    Thread.Sleep(0xbb8);
                    if (Regex.IsMatch(str5, "^[0-9'']"))
                    {
                        datarow.newrow("Card Number", str5, str5, "PASS", driver, selenium);
                    }
                    else if (selenium.IsTextPresent("Number required") || selenium.IsTextPresent("Number invalid"))
                    {
                        datarow.newrow("Card Number", str5, "Number Invalid", "PASS", driver, selenium);
                    }
                    else
                    {
                        datarow.newrow("Card Number", str5, "No Error Message Displayed", "FAIL", driver, selenium);
                        screenshot.screenshotfailed(driver, selenium);
                    }
                    if (expected == null)
                    {
                        if (selenium.IsTextPresent("Type required"))
                        {
                            datarow.newrow("Card Type", expected, "Type Required", "PASS", driver, selenium);
                        }
                        else
                        {
                            datarow.newrow("Card Type", expected, expected, "FAIL", driver, selenium);
                            screenshot.screenshotfailed(driver, selenium);
                        }
                    }
                    else
                    {
                        datarow.newrow("Card Type", "VISA", "VISA", "PASS", driver, selenium);
                    }
                    Regex regex = new Regex("^[0-9]{3}$");
                    if (regex.IsMatch(str6))
                    {
                        datarow.newrow("Security Code", str6, "Valid 3 Digits", "PASS", driver, selenium);
                    }
                    else if (selenium.IsTextPresent("Security code required") || selenium.IsTextPresent("Security code invalid"))
                    {
                        datarow.newrow("Security Code", str6, "Security code required", "PASS", driver, selenium);
                    }
                    else
                    {
                        datarow.newrow("Security Code", str6, "No Error Message Displayed", "FAIL", driver, selenium);
                        screenshot.screenshotfailed(driver, selenium);
                    }
                    if (Regex.IsMatch(str8, "^[a-zA-Z'']"))
                    {
                        datarow.newrow("Name on Card", str8, str8, "PASS", driver, selenium);
                    }
                    else if (selenium.IsTextPresent("Name required"))
                    {
                        datarow.newrow("Name on Card", str8, "Name Required", "PASS", driver, selenium);
                    }
                    else
                    {
                        datarow.newrow("Name on Card", str8, "No Error Message Displayed", "PASS", driver, selenium);
                        screenshot.screenshotfailed(driver, selenium);
                    }
                    if (Regex.IsMatch(input, "^[a-zA-Z'']"))
                    {
                        datarow.newrow("First Name", input, input, "PASS", driver, selenium);
                    }
                    else if (selenium.IsTextPresent("The First Name field is required."))
                    {
                        datarow.newrow("First Name", input, "The First Name field is required.", "PASS", driver, selenium);
                    }
                    else
                    {
                        datarow.newrow("First Name", input, "No Error Message Displayed", "FAIL", driver, selenium);
                        screenshot.screenshotfailed(driver, selenium);
                    }
                    if (Regex.IsMatch(str4, "^[a-zA-Z'']"))
                    {
                        datarow.newrow("Last Name", str4, str4, "PASS", driver, selenium);
                    }
                    else if (selenium.IsTextPresent("The Last Name field is required."))
                    {
                        datarow.newrow("Last Name", str4, "The Last Name field is required.", "PASS", driver, selenium);
                    }
                    else
                    {
                        datarow.newrow("Last Name", str4, "No Error message Displayed", "FAIL", driver, selenium);
                        screenshot.screenshotfailed(driver, selenium);
                    }
                    if (Regex.IsMatch(str13, "^[a-zA-Z0-9'']"))
                    {
                        datarow.newrow("Address", str13, str13, "PASS", driver, selenium);
                    }
                    else if (selenium.IsTextPresent("The Address field is required"))
                    {
                        datarow.newrow("Address", str13, "The Address field is required", "PASS", driver, selenium);
                    }
                    else
                    {
                        datarow.newrow("Address", str13, "No Error message Displayed", "FAIL", driver, selenium);
                        screenshot.screenshotfailed(driver, selenium);
                    }
                    if (Regex.IsMatch(str15, "^[a-zA-Z0-9'']"))
                    {
                        datarow.newrow("Post Code", str15, str15, "PASS", driver, selenium);
                    }
                    else if (selenium.IsTextPresent("The Postcode field is required"))
                    {
                        datarow.newrow("Post Code", str15, "The Postcode field is required.", "PASS", driver, selenium);
                    }
                    else
                    {
                        datarow.newrow("Post Code", str15, "No Error Message Displayed", "FAIL", driver, selenium);
                        screenshot.screenshotfailed(driver, selenium);
                    }
                    if (Regex.IsMatch(str17, "^[a-zA-Z'']"))
                    {
                        datarow.newrow("Country", str17, str17, "PASS", driver, selenium);
                    }
                    else if (selenium.IsTextPresent("The Country field is required."))
                    {
                        datarow.newrow("Country", str17, "The Country field is required.", "PASS", driver, selenium);
                    }
                    else
                    {
                        datarow.newrow("Country", str17, "No Error Message", "FAIL", driver, selenium);
                        screenshot.screenshotfailed(driver, selenium);
                    }
                    if (selenium.GetTitle() == "Secure Payment Page")
                    {
                    }
                    string location = selenium.GetLocation();
                    string str22 = driver.Title.ToString();
                    if (location.Contains("State=Accepted") || str22.Contains("Payment Accepted"))
                    {
                        datarow.newrow("Transaction", location, "State=Accepted", "PASS", driver, selenium);
                        break;
                    }
                    if (location.Contains("State=NotAccepted"))
                    {
                        datarow.newrow("Transaction", location, "Transaction Declined", "FAIL", driver, selenium);
                        break;
                    }
                    if ((selenium.IsTextPresent("Checkout Declined") || selenium.IsTextPresent("Checkout Error")) || selenium.IsTextPresent("Not Found"))
                    {
                        datarow.newrow("Checkout", "Checkout Declined", "Checkout Declined", "PASS", driver, selenium);
                        break;
                    }
                }
                catch (Exception exception2)
                {
                    Console.Write(exception2);
                    string str23 = exception2.ToString();
                    MoBankUI.Screenshot screenshot2 = new MoBankUI.Screenshot();
                    datarow.newrow("Exception", "Exceptio not Expected", str23, "FAIL", driver, selenium);
                    screenshot2.screenshotfailed(driver, selenium);
                }
            }
        }
    }
}
