// Generated by .NET Reflector from C:\Program Files\Default Company Name\Selenium Test Tool\MoBankUI.exe
namespace MoBankUI
{
    using OpenQA.Selenium;
    using OpenQA.Selenium.Support.UI;
    using Selenium;
    using System;
    using System.Threading;
    
    public class Checkout
    {
        public void checkout(IWebDriver driver, ISelenium selenium, datarow datarow)
        {
            driver.FindElement(By.LinkText("Checkout")).Click();
            selenium.WaitForPageToLoad("30000");
            datarow.newrow("", "", "CHECKOUT", "", driver, selenium);
            string actual = driver.Title.ToString();
            if (actual == "Checkout : mobank.co.uk/MoShop")
            {
                datarow.newrow("Checkout Title", "Checkout : mobank.co.uk/MoShop", actual, "PASS", driver, selenium);
            }
            else
            {
                datarow.newrow("Checkout Title", "Checkout : mobank.co.uk/MoShop", actual, "PASS", driver, selenium);
            }
            Thread.Sleep(0x7d0);
            driver.FindElement(By.Id("CheckoutProcesses_0__Name")).Clear();
            driver.FindElement(By.Id("CheckoutProcesses_0__Name")).SendKeys("Tickle (copy of QA by SB)");
            driver.FindElement(By.Id("PaymentAccountIdentifier")).Clear();
            driver.FindElement(By.Id("PaymentAccountIdentifier")).SendKeys("59f285d7-6de0-48f3-917c-40de0177e13f");
            driver.FindElement(By.CssSelector("input.button")).Click();
            selenium.WaitForPageToLoad("30000");
            Thread.Sleep(0x7d0);
            string attribute = driver.FindElement(By.Id("CheckoutProcesses_0__Name")).GetAttribute("Value");
            if (attribute == "")
            {
                driver.FindElement(By.Id("CheckoutProcesses_0__Name")).SendKeys("Tickle (copy of QA by SB)");
                driver.FindElement(By.CssSelector("input.button")).Click();
                selenium.WaitForPageToLoad("30000");
                Thread.Sleep(0x7d0);
            }
            string str3 = driver.FindElement(By.Id("PaymentAccountIdentifier")).GetAttribute("Value");
            if (attribute == "Tickle (copy of QA by SB)")
            {
                datarow.newrow("Checkout Name", "Tickle (copy of QA by SB)", attribute, "PASS", driver, selenium);
            }
            else
            {
                datarow.newrow("Checkout Name", "Tickle (copy of QA by SB)", attribute, "FAIL", driver, selenium);
            }
            if (str3 == "59f285d7-6de0-48f3-917c-40de0177e13f")
            {
                datarow.newrow("Payment Identifier", "59f285d7-6de0-48f3-917c-40de0177e13f", str3, "PASS", driver, selenium);
            }
            else
            {
                datarow.newrow("Payment Identifier", "59f285d7-6de0-48f3-917c-40de0177e13f", str3, "FAIL", driver, selenium);
            }
            Thread.Sleep(0x7d0);
            driver.FindElement(By.Id("DefaultCheckoutProcessId")).Click();
            driver.FindElement(By.CssSelector("input.button")).Click();
            selenium.WaitForPageToLoad("30000");
            driver.FindElement(By.LinkText("…")).Click();
            selenium.WaitForPageToLoad("30000");
            string str4 = driver.Title.ToString();
            if (str4 == "Checkout Process : mobank.co.uk/MoShop")
            {
                datarow.newrow("Checkout Process Page Title", "Checkout Process : mobank.co.uk/MoShop", str4, "PASS", driver, selenium);
            }
            else
            {
                datarow.newrow("Checkout Process Page Title", "Checkout Process : mobank.co.uk/MoShop", str4, "FAIL", driver, selenium);
            }
            new SelectElement(driver.FindElement(By.Id("Encoding_Value"))).SelectByText("iso-8859-1 - Western European (ISO)");
            driver.FindElement(By.Id("BasketPage_Url")).Clear();
            driver.FindElement(By.Id("BasketPage_Url")).SendKeys("http://www.the-tickle-company.co.uk/cgi-bin/ca000001.pl");
            new SelectElement(driver.FindElement(By.Id("BasketPage_Method"))).SelectByText("POST");
            driver.FindElement(By.Id("BasketPage_Parameters")).Clear();
            driver.FindElement(By.Id("BasketPage_Parameters")).SendKeys("SID=915&PAGE=PRODUCT&Q_{{ProductCode}}={{Quantity}}");
            driver.FindElement(By.Id("BasketPage_SuccessSelector")).Clear();
            driver.FindElement(By.Id("BasketPage_SuccessSelector")).SendKeys("#productsresults form h2");
            driver.FindElement(By.Id("BasketPage_ErrorMessageSelector")).Clear();
            driver.FindElement(By.Id("BasketPage_ErrorMessageSelector")).SendKeys("body");
            driver.FindElement(By.Id("BasketPage_ErrorMessageTransformer")).Clear();
            driver.FindElement(By.Id("BasketPage_ErrorMessageTransformer")).SendKeys(@"(?<=\<hr \/\>).*(?=\<hr \/\>)");
            driver.FindElement(By.Id("BasketPage_BasketTotalSelector")).Clear();
            driver.FindElement(By.Id("BasketPage_BasketTotalSelector")).SendKeys("div#productsresults table:eq(0) tr:last-child td strong:eq(1)");
            Thread.Sleep(0x7d0);
            driver.FindElement(By.XPath("//div[@id='configureCheckoutForm']/div[2]/h3")).Click();
            int num = 0;
            if (selenium.IsElementPresent("css=h3.collapsible.collapsed"))
            {
                driver.FindElement(By.CssSelector("h3.collapsible.collapsed")).Click();
                num++;
            }
            if (selenium.IsElementPresent("//div[@id='configureCheckoutForm']/div[4]/h3"))
            {
                if (num == 0)
                {
                    driver.FindElement(By.XPath("//div[@id='configureCheckoutForm']/div[4]/h3")).Click();
                    Thread.Sleep(0x7d0);
                }
                if (selenium.IsVisible("id=CountryMappings_0__Source"))
                {
                    driver.FindElement(By.Id("CountryMappings_0__Source")).Clear();
                    driver.FindElement(By.Id("CountryMappings_0__Source")).SendKeys("UK");
                    new SelectElement(driver.FindElement(By.Id("CountryMappings_0__Target"))).SelectByText("GB - United Kingdom");
                }
            }
            driver.FindElement(By.CssSelector("input.button")).Click();
            selenium.WaitForPageToLoad("30000");
            driver.FindElement(By.Id("Pages_0__Name")).Clear();
            driver.FindElement(By.Id("Pages_0__Name")).SendKeys("Address");
            driver.FindElement(By.CssSelector("input.button")).Click();
            selenium.WaitForPageToLoad("30000");
            driver.FindElement(By.Id("Pages_1__Name")).Clear();
            driver.FindElement(By.Id("Pages_1__Name")).SendKeys("Delivery");
            driver.FindElement(By.CssSelector("input.button")).Click();
            selenium.WaitForPageToLoad("30000");
            if (driver.FindElement(By.Id("Pages_1__Name")).GetAttribute("Value") == "")
            {
                driver.FindElement(By.Id("Pages_1__Name")).Clear();
                driver.FindElement(By.Id("Pages_1__Name")).SendKeys("Delivery");
                driver.FindElement(By.CssSelector("input.button")).Click();
                selenium.WaitForPageToLoad("30000");
            }
            driver.FindElement(By.Id("Pages_2__Name")).Clear();
            driver.FindElement(By.Id("Pages_2__Name")).SendKeys("Confirm");
            driver.FindElement(By.CssSelector("input.button")).Click();
            selenium.WaitForPageToLoad("30000");
            if (driver.FindElement(By.Id("Pages_2__Name")).GetAttribute("Value") == "")
            {
                driver.FindElement(By.Id("Pages_2__Name")).Clear();
                driver.FindElement(By.Id("Pages_2__Name")).SendKeys("Confirm");
                driver.FindElement(By.CssSelector("input.button")).Click();
                selenium.WaitForPageToLoad("30000");
            }
            string str7 = driver.FindElement(By.Id("Encoding_Value")).GetAttribute("Value");
            string str8 = driver.FindElement(By.Id("BasketPage_Url")).GetAttribute("Value");
            string str9 = driver.FindElement(By.Id("BasketPage_Parameters")).GetAttribute("Value");
            string str10 = driver.FindElement(By.Id("BasketPage_SuccessSelector")).GetAttribute("Value");
            string str11 = driver.FindElement(By.Id("BasketPage_ErrorMessageSelector")).GetAttribute("Value");
            string str12 = driver.FindElement(By.Id("BasketPage_ErrorMessageTransformer")).GetAttribute("Value");
            string str13 = driver.FindElement(By.Id("BasketPage_BasketTotalSelector")).GetAttribute("Value");
            string str14 = driver.FindElement(By.Id("CountryMappings_0__Source")).GetAttribute("Value");
            if (str8 == "http://www.the-tickle-company.co.uk/cgi-bin/ca000001.pl")
            {
                datarow.newrow("Basket Page URL", "http://www.the-tickle-company.co.uk/cgi-bin/ca000001.pl", str8, "PASS", driver, selenium);
            }
            else
            {
                datarow.newrow("Basket Page URL", "http://www.the-tickle-company.co.uk/cgi-bin/ca000001.pl", str8, "FAIL", driver, selenium);
            }
            if (str9 == "SID=915&PAGE=PRODUCT&Q_{{ProductCode}}={{Quantity}}")
            {
                datarow.newrow("Basket Page Parameters", "SID=915&PAGE=PRODUCT&Q_{{ProductCode}}={{Quantity}}", str9, "PASS", driver, selenium);
            }
            else
            {
                datarow.newrow("Basket Page Parameters", "SID=915&PAGE=PRODUCT&Q_{{ProductCode}}={{Quantity}}", str9, "FAIL", driver, selenium);
            }
            if (str10 == "#productsresults form h2")
            {
                datarow.newrow("Basket Success Selector", "#productsresults form h2", str10, "PASS", driver, selenium);
            }
            else
            {
                datarow.newrow("Basket Success Selector", "#productsresults form h2", str10, "FAIL", driver, selenium);
            }
            if (str11 == "body")
            {
                datarow.newrow("Basket Error Message", "body", str11, "PASS", driver, selenium);
            }
            else
            {
                datarow.newrow("Basket Error Message", "body", str11, "FAIL", driver, selenium);
            }
            if (str12 == @"(?<=\<hr \/\>).*(?=\<hr \/\>)")
            {
                datarow.newrow("Basket Error Transformation", @"(?<=\<hr \/\>).*(?=\<hr \/\>)", str12, "PASS", driver, selenium);
            }
            else
            {
                datarow.newrow("Basket Error Transformation", @"(?<=\<hr \/\>).*(?=\<hr \/\>)", str12, "FAIL", driver, selenium);
            }
            if (str13 == "div#productsresults table:eq(0) tr:last-child td strong:eq(1)")
            {
                datarow.newrow("Basket Total Selector", "div#productsresults table:eq(0) tr:last-child td strong:eq(1)", str13, "PASS", driver, selenium);
            }
            else
            {
                datarow.newrow("Basket Total Selector", "div#productsresults table:eq(0) tr:last-child td strong:eq(1)", str13, "PASS", driver, selenium);
            }
            if (str14 == "UK")
            {
                datarow.newrow("Country Mappings", "UK", str14, "PASS", driver, selenium);
            }
            else
            {
                datarow.newrow("Country Mappings", "UK", str14, "FAIL", driver, selenium);
            }
            string str15 = driver.FindElement(By.Id("Pages_0__Name")).GetAttribute("Value");
            string str16 = driver.FindElement(By.Id("Pages_1__Name")).GetAttribute("Value");
            string str17 = driver.FindElement(By.Id("Pages_2__Name")).GetAttribute("Value");
            if (str15 == "Address")
            {
                datarow.newrow("Chekout Address", "Address", str15, "PASS", driver, selenium);
            }
            else
            {
                datarow.newrow("Chekout Address", "Address", str15, "FAIL", driver, selenium);
            }
            if (str16 == "Delivery")
            {
                datarow.newrow("Checkout Delivery", "Delivery", str16, "PASS", driver, selenium);
            }
            else
            {
                datarow.newrow("Checkout Delivery", "Delivery", str16, "FAIL", driver, selenium);
            }
            if (str17 == "Confirm")
            {
                datarow.newrow("Checkout Confirmation", "Confirm", str17, "PASS", driver, selenium);
            }
            else
            {
                datarow.newrow("Checkout Confirmation", "Confirm", str17, "FAIL", driver, selenium);
            }
            driver.FindElement(By.LinkText("…")).Click();
            selenium.WaitForPageToLoad("30000");
            string str18 = driver.Title.ToString();
            if (str18 == "Page Update : mobank.co.uk/MoShop")
            {
                datarow.newrow("Address Page Title", "Page Update : mobank.co.uk/MoShop", str18, "PASS", driver, selenium);
            }
            else
            {
                datarow.newrow("Address Page Title", "Page Update : mobank.co.uk/MoShop", str18, "FAIL", driver, selenium);
            }
            new Addressconfig().addressconfig(driver, selenium, datarow);
        }
    }
}
