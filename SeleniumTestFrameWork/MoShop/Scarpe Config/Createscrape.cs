// Generated by .NET Reflector from C:\Program Files\Default Company Name\ Test Tool\MoBankUI.exe

using System;
using NUnit.Framework;
using OpenQA.Selenium;
using WebDriver_Refining;

namespace MoBankUI
{
    public class Createscrape : driverdefining
    {
        [Test]
        public void createscrape(IWebDriver driver, datarow datarow)
        {
            try
            {
                driver.FindElement(By.LinkText("MoShop")).Click();

                string actual = driver.Title;
                if (actual == "mobank.co.uk/MoShop")
                {
                    datarow.newrow("HomePage Title", "mobank.co.uk/MoShop", actual, "PASS", driver);
                }
                else
                {
                    datarow.newrow("HomePage Title", "mobank.co.uk/MoShop", actual, "FAIL", driver);
                }
                driver.FindElement(By.LinkText("Scrapes")).Click();

                string str2 = driver.Title;
                if (str2 == "Scrapes : mobank.co.uk/MoShop")
                {
                    datarow.newrow("Scrape Page Title", "Scrapes :  mobank.co.uk/MoShop", str2, "PASS", driver);
                }
                else
                {
                    datarow.newrow("Scrape Page Title", "Scrapes :  mobank.co.uk/MoShop", str2, "FAIL", driver);
                }


                driver.FindElement(By.LinkText("Create")).Click();
                driver.FindElement(By.Id("Name")).Clear();
                driver.FindElement(By.Id("Name")).SendKeys("TestShop-Scrape");
                driver.FindElement(By.CssSelector("p.submit.submitInline > input.button")).Click();

                Selectanoption(driver, By.Id("Profiles_0__Shop_Value"), "testshop");
                //new SelectElement(driver.FindElement(By.Id("Profiles_0__Shop_Value"))).SelectByText("testshop");
                driver.FindElement(By.CssSelector("input.button")).Click();


                string str3 = driver.Title;
                if (str3 == "Scrape : mobank.co.uk/MoShop")
                {
                    datarow.newrow("Scrape Title", "Scrape :  mobank.co.uk/MoShop", str3, "PASS", driver);
                }
                else
                {
                    datarow.newrow("Scrape Title", "Scrape :  mobank.co.uk/MoShop", str3, "FAIL", driver);
                }
                driver.FindElement(By.Id("Profiles_0__RootUrl")).Clear();
                driver.FindElement(By.Id("Profiles_0__RootUrl")).SendKeys("http://www.the-tickle-company.co.uk/");
                Selectanoption(driver, By.Id("Profiles_0__Encoding"), "iso-8859-1 - Western European (ISO)");
                //new SelectElement(driver.FindElement(By.Id("Profiles_0__Encoding"))).SelectByText("iso-8859-1 - Western European (ISO)");
                driver.FindElement(By.CssSelector("input.button")).Click();

                string attribute = driver.FindElement(By.Id("Profiles_0__RootUrl")).GetAttribute("Value");
                string str5 = driver.FindElement(By.Id("Profiles_0__Encoding")).GetAttribute("Value");
                if (attribute == "http://www.the-tickle-company.co.uk/")
                {
                    datarow.newrow("Root URL", "http://www.the-tickle-company.co.uk/", attribute, "PASS", driver);
                }
                else
                {
                    datarow.newrow("Root URL", "http://www.the-tickle-company.co.uk/", attribute, "FAIL", driver);
                }
                driver.FindElement(By.Id("Pages_0__Name")).Clear();
                driver.FindElement(By.Id("Pages_0__Name")).SendKeys("Categories");
                Selectanoption(driver, By.Id("Pages_0__ObjectTypeName"), "Category");
                //new SelectElement(driver.FindElement(By.Id("Pages_0__ObjectTypeName"))).SelectByText("Category");
                driver.FindElement(By.CssSelector("input.button")).Click();

                string str6 = driver.FindElement(By.Id("Pages_0__Name")).GetAttribute("Value");
                string str7 = driver.FindElement(By.Id("Pages_0__ObjectTypeName")).GetAttribute("option value");
                if (str6 == "Categories")
                {
                    datarow.newrow("Page Name", "Categories", str6, "PASS", driver);
                }
                else
                {
                    datarow.newrow("Page Name", "Categories", str6, "FAIL", driver);
                }
                driver.FindElement(By.XPath("(//a[contains(text(),'…')])[2]")).Click();

                if (driver.PageSource.Contains("Server Error in '/' Application."))
                {
                    driver.Navigate().Back();

                    driver.FindElement(By.CssSelector("input.button")).Click();

                    driver.FindElement(By.XPath("(//a[contains(text(),'…')])[2]")).Click();
                }
            }
            catch (Exception ex)
            {
                string e = ex.ToString();
                datarow.newrow("Exception", "", e, "FAIL");
            }
            new CategoryScrape().ScarpeCategory(driver, datarow);
        }
    }
}