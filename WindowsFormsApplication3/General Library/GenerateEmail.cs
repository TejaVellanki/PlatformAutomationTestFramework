// Generated by .NET Reflector from C:\Program Files\Default Company Name\Selenium Test Tool\MoBankUI.exe
namespace MoBankUI
{
    using System;
    using System.Net;
    using System.Net.Mail;
    using System.Text;
    
    internal class GenerateEmail
    {
        public void SendEMail(string ReportName, string emails)
        {
            try
            {
                MailMessage message = new MailMessage {
                    From = new MailAddress("admin@mobankgroup.com")
                };
                string[] strArray = emails.Split(new char[] { ',' });
                foreach (string str in strArray)
                {
                    message.To.Add(str);
                }
                message.To.Add("teja.vellanki@mobankgroup.com");
                message.Subject = "Test Report";
                message.Attachments.Add(new Attachment(@"C:\Selenium\Input Data\" + ReportName + ".xlsx"));
                StringBuilder builder = new StringBuilder();
                builder.AppendFormat("<h1>MoPowered</h1>", new object[0]);
                builder.AppendFormat("Dear Sir/Madam,", new object[0]);
                builder.AppendFormat("<br />", new object[0]);
                builder.AppendFormat("<p>An Automation Test has been processed.Please find the Excel workbook attached for the Test Results</p>", new object[0]);
                builder.AppendFormat("<br />", new object[0]);
                builder.AppendFormat("<p>Thank You</p>", new object[0]);
                builder.AppendFormat("<br />", new object[0]);
                builder.AppendFormat("<p>Selenium</p>", new object[0]);
                message.Body = builder.ToString();
                message.IsBodyHtml = true;
                new SmtpClient("smtp.gmail.com") { Port = 0x24b, Credentials = new NetworkCredential("teja.vellanki@mobankgroup.com", "Apple12345"), EnableSsl = true }.Send(message);
            }
            catch (Exception exception)
            {
                Console.Write(exception);
            }
        }
    }
}
