// Generated by .NET Reflector from C:\Program Files\Default Company Name\Selenium Test Tool\MoBankUI.exe
namespace MoBankUI
{
    using OpenQA.Selenium;
    using OpenQA.Selenium.Support.UI;
    using Selenium;
    using System;
    
    internal class links_TPS
    {
        private MoBankUI.Screenshot screenshot = new MoBankUI.Screenshot();
        
        public void Links(datarow_TPS datarow, IWebDriver driver, ISelenium selenium, string url)
        {
            string str2;
            try
            {
                Imagevalidation imagevalidation = new Imagevalidation();
                driver.Navigate().GoToUrl(url);
                selenium.WaitForPageToLoad("30000");
                imagevalidation.homepageimage(driver, selenium, datarow);
                decimal count = driver.FindElements(By.XPath("//html/body/div/div[2]/div/ul/li")).Count;
                if (count == 0M)
                {
                    datarow.newrowTPS("Category Validation in Home Page", "Atleast One Category/product is Expected", "No Categories/Products are Identified", "FAIL", driver, selenium);
                }
                int num2 = 0;
                int num3 = 1;
                for (int i = 1; i <= count; i++)
                {
                    Exception exception;
                    bool flag;
                    try
                    {
                        driver.Manage().Timeouts().ImplicitlyWait(TimeSpan.FromSeconds(10.0));
                        IWebElement element = driver.FindElement(By.XPath("//html/body/div/div[2]/div/ul/li[" + i + "]/div/div/a/h2"));
                        driver.FindElement(By.XPath("//html/body/div/div[2]/div/ul/li[" + i + "]/div/div/a/h2")).Click();
                        selenium.WaitForPageToLoad("30000");
                        string str = driver.Title.ToString();
                    }
                    catch (Exception exception1)
                    {
                        exception = exception1;
                        str2 = exception.ToString();
                        datarow.newrowTPS("Category Element Exception", "Exception Not Expected", str2, "FAIL", driver, selenium);
                        this.screenshot.screenshotfailed(driver, selenium);
                    }
                    if (selenium.GetXpathCount("//html/body/div/div[2]/div/ul/li") == 0M)
                    {
                        datarow.newrowTPS("Category Validation in  Page", "Atleast One Category/product", "No Categories/Products", "FAIL", driver, selenium);
                        this.screenshot.screenshotfailed(driver, selenium);
                    }
                    int num6 = 1;
                    goto Label_0643;
                Label_019E:;
                    try
                    {
                        if (!selenium.IsElementPresent("//html/body/div/div[2]/div/ul/li[" + num6 + "]/div/div/a/h2"))
                        {
                            goto Label_05A0;
                        }
                        string location = selenium.GetLocation();
                        imagevalidation.categoryimage(driver, selenium, datarow);
                        driver.FindElement(By.XPath("//html/body/div/div[2]/div/ul/li[" + num6 + "]/div/div/a/h2")).Click();
                        selenium.WaitForPageToLoad("30000");
                        string actual = driver.Title.ToString();
                        string str5 = selenium.GetLocation();
                        imagevalidation.subcategoryimage(driver, selenium, datarow);
                        if (str5.Contains("category"))
                        {
                            datarow.newrowTPS("Category Title", "", actual, "PASS", driver, selenium);
                            num6 = 0;
                            goto Label_063B;
                        }
                        try
                        {
                            string str9;
                            string text;
                            imagevalidation.productImage(driver, selenium, datarow);
                            datarow.newrowTPS("Product Title", "", actual, "PASS", driver, selenium);
                            if (selenium.IsElementPresent("//body[@id='page-products-details']/div/div[2]/div/div/div/p/strong"))
                            {
                                string str6 = driver.FindElement(By.XPath("//body[@id='page-products-details']/div/div[2]/div/div/div/p/strong")).Text;
                                datarow.newrowTPS("Product Price", "", str6, "PASS", driver, selenium);
                            }
                            if (selenium.IsElementPresent("//div[@id='Description']/h4/a/span"))
                            {
                                selenium.Click("//div[@id='Description']/h4/a/span");
                                if (selenium.IsElementPresent("//div[@id='Description']/div/div/div/p"))
                                {
                                    string str7 = selenium.GetText("css=html.ui-mobile body#page-products-details.ui-mobile-viewport div.ui-page div.pageContent div.productDetails div.ui-content div#Description.ui-collapsible div.ui-collapsible-content");
                                    datarow.newrowTPS("Product Detail", "", str7, "PASS", driver, selenium);
                                }
                            }
                            if (selenium.IsElementPresent("//html/body/div/div/div[2]/h2"))
                            {
                                string str8 = selenium.GetText("//html/body/div/div/div[2]/h2");
                                datarow.newrowTPS("Product Title", "", str8, "PASS", driver, selenium);
                            }
                            if (selenium.IsElementPresent("id=Variants_0__OptionValue"))
                            {
                                if (selenium.GetXpathCount("//html/body/div/div[2]/div/div[4]/form/ul/li[2]/fieldset/div[2]/div/label/span") != 1M)
                                {
                                    string[] selectOptions = selenium.GetSelectOptions("id=Variants_0__OptionValue");
                                    str9 = null;
                                    foreach (string str10 in selectOptions)
                                    {
                                        if (str10 != "Please Select")
                                        {
                                            str9 = str9 + "\r\n" + str10;
                                            new SelectElement(driver.FindElement(By.Id("Variants_0__OptionValue"))).SelectByText(str10);
                                        }
                                    }
                                    datarow.newrowTPS("Variants", "", str9, "PASS", driver, selenium);
                                }
                                else
                                {
                                    text = selenium.GetValue("id=Variants_0__OptionValue");
                                    datarow.newrowTPS("Variants", "", text, "PASS", driver, selenium);
                                }
                                goto Label_0583;
                            }
                            if (!selenium.IsElementPresent("id=OptionValue_0"))
                            {
                                goto Label_0583;
                            }
                            str9 = null;
                            int num8 = 1;
                            goto Label_0526;
                        Label_0498:
                            if (!selenium.IsElementPresent("id=OptionValue_" + num8))
                            {
                                goto Label_052E;
                            }
                            text = selenium.GetText("id=OptionValue_" + num8);
                            if ((text != "Please Select") || (text != null))
                            {
                                str9 = str9 + "\r\n" + text;
                                selenium.Click("id=OptionValue_" + num8);
                            }
                            num8++;
                        Label_0526:
                            flag = true;
                            goto Label_0498;
                        Label_052E:
                            datarow.newrowTPS("Variants", "", str9, "PASS", driver, selenium);
                        }
                        catch (Exception exception2)
                        {
                            exception = exception2;
                            str2 = exception.ToString();
                            datarow.newrowTPS("Exception For Product Details", "Exception Not Expected", str2, "FAIL", driver, selenium);
                            this.screenshot.screenshotfailed(driver, selenium);
                        }
                    Label_0583:
                        driver.Navigate().Back();
                        selenium.WaitForPageToLoad("30000");
                        goto Label_063B;
                    Label_05A0:
                        num6 = num3;
                        driver.Navigate().Back();
                        selenium.WaitForPageToLoad("30000");
                        num3++;
                        string str12 = selenium.GetLocation();
                        if (str12.Contains("category"))
                        {
                            datarow.newrowTPS("Category URL", "", str12, "PASS", driver, selenium);
                        }
                        else
                        {
                            num3 = 1;
                            goto Label_064B;
                        }
                    }
                    catch (Exception exception3)
                    {
                        str2 = exception3.ToString();
                        datarow.newrowTPS("Category/Product Link Exception", "Exception Not Expected", str2, "FAIL", driver, selenium);
                        this.screenshot.screenshotfailed(driver, selenium);
                    }
                Label_063B:
                    num6++;
                Label_0643:
                    flag = true;
                    goto Label_019E;
                Label_064B:
                    num2++;
                }
            }
            catch (Exception exception4)
            {
                str2 = exception4.ToString();
                datarow.newrowTPS("Exception", "", "Exception Not Expected", "FAIL", driver, selenium);
                this.screenshot.screenshotfailed(driver, selenium);
            }
        }
    }
}
